{% load bcse_extras %}
{% load base_extras %}
<table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Submission ID</th>
        <th>IP Address</th>
        <th> User ID </th>
        <th> Email </th>
        <th> Full Name </th>
        <th> Created Date </th>
        <th> Status </th>
        {% if parent == "page" %}
          <th> Action </th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{submission.UUID}}</td>
        <td>{{submission.ip_address}}</td>
        <td>{{submission.user.id|default_if_none:""}}</td>
        <td>{{submission.user.user.email|default_if_none:""}}</td>
        <td>{{submission.user.user.get_full_name|default_if_none:""}}</td>
        <td>{{submission.created_date|date}}</td>
        <td>{{submission.get_status_display}}</td> 
        {% if parent == "page" %}
          <td>
            <div class="btn-group">
              <button type="button" class="btn btn-small dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                Action
              </button>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item action modal-open" data-bs-toggle="modal" data-bs-target="#survey_submission" data-href="{% url 'bcse:surveySubmissionEdit' survey.id submission.UUID %}" href="#">
                    Edit
                  </a>
                </li>
                <li><hr class="dropdown-divider"></li>
                <li>
                  <a class="dropdown-item action delete" data-href="{% url 'bcse:surveySubmissionDelete' survey.id submission.UUID %}"
                    data-title="the survey submission <strong>{{submission.UUID}}</strong>">
                    Delete
                  </a>
                </li>
              </ul>
            </div>
          </td>
        {% endif %}
      </tr>      
    </tbody>
  </table>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Page</th>
        <th>Order</th>
        <th>Type</th>
        <th>Content</th>
        <th>Options</th>
        <th>Is Required</th>
        <th>Response</th>
        <th>Created Date</th>
      </tr>
    </thead>
    <tbody>
      {% for response in surveyResponses %}
        <tr>
          <td>{{response.survey_component.page}}</td>
          <td>{{response.survey_component.order}}</td>
          <td>{{response.survey_component.get_component_type_display}}</td>
          <td>{{response.survey_component.content|safe}}</td>
          <td>{{response.survey_component.options|default_if_none:"N/A"}}</td>
          <td>{{response.survey_component.is_required|yesno:"Yes,No"}}</td>
          <td>{{response.response}}</td>
          <td>{{response.created_date|date}}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
